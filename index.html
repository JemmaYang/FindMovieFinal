<!DOCTYPE html>
<html lang="en">
  <title>Find Your Movie</title>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Domine" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="public/mixitup.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>
   
    <link rel="stylesheet" href="public/ion.rangeSlider.css" />
    <link rel="stylesheet" href="public/ion.rangeSlider.skinHTML5.css"/>
    <script src="public/ion.rangeSlider.min.js"></script>

    <link rel="stylesheet" href="public/style.css">
  </head>

  <body>
     <nav class="navbar navbar-inverse">
        <div class="container-fluid">
           <div class="navbar-header">
              <img id="logo" src="public/images/logo.png">
              <h1 class="title">Find Your Movie</h1>
           </div>
           <div class="nav navbar-nav navbar-right dropdown">
              <div class="signed">Hello! Jemma<img id="signed" src="public/images/me.jpg"></div>
              <a href="profile.html" class="dropdown-content">My Playlist</a>     
           </div>            
        </div>
    </nav>

    <nav class="sidebar col-md-3">
      <div id="searchArea">
          <label class="sr-only" for="searchbox">Search</label>
          <input type="text" class="form-control" id="searchbox" placeholder="Search &hellip;" autocomplete="off">
          <span class="glyphicon glyphicon-search search-icon"></span>
      </div>
        
      <div class="well">
            <fieldset id="genre_criteria" class="dropdown">
              <legend class="control-label">Genre</legend>
              <input id="genreText" type="text" placeholder="Choose following... &nbsp;&#9662;"> 
              <div id="genres" class="dropdown-content">
                 <div class="checkbox">
                  <label>
                    <input type="checkbox" data-toggle=".Action" id="Action" onchange="run(this.id)">
                    <span>Action<span>
                  </label>
                 </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" data-toggle=".Adventure" id="Adventure" onchange="run(this.id)">
                    <span>Adventure</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" data-toggle=".Animation" id="Animated" onchange="run(this.id)">
                    <span>Animation</span> 
                   </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" data-toggle=".Biography" id="Biography" onchange="run(this.id)">
                    <span>Biography</span>
                  </label>
                </div>
                <div class="checkbox">
                    <label>
                    <input type="checkbox" data-toggle=".Comedy" id="Comedy" onchange="run(this.id)">
                    <span>Comedy</span>
                  </label>
                </div>
                <div class="checkbox">
                    <label>
                    <input type="checkbox" data-toggle=".Documentary" id="Documentary" onchange="run(this.id)">
                    <span>Documentary</span>
                  </label>
                </div>
                <div class="checkbox">
                    <label>
                    <input type="checkbox" data-toggle=".Drama" id="Drama" onchange="run(this.id)">
                    <span>Drama</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                    <input type="checkbox" data-toggle=".Horror" id="Horror" onchange="run(this.id)">
                    <span>Horror</span>
                  </label>
                </div>
                <div class="checkbox">
                    <label>
                    <input type="checkbox" data-toggle=".Romance" id="Romance" onchange="run(this.id)">
                    <span>Romance</span>
                  </label>
                </div>
                <div class="checkbox">
                    <label>
                    <input type="checkbox" data-toggle=".Sci-Fi" id="Sci-Fi & Fantasy" onchange="run(this.id)">
                    <span>Sci-Fi & Fantasy</span> 
                  </label>
                </div>
                <div class="checkbox">
                    <label>
                    <input type="checkbox" data-toggle=".Thriller" id="Thriller" onchange="run(this.id)">
                    <span>Thriller</span> 
                  </label>
                </div>
              </div>    
            </fieldset>
        </div>

        <div class="well">
            <fieldset id="runtime_criteria">
                <legend>Year</legend>
                <input type="text" id="yearRange" value="" name="yearRange" />
            </fieldset>
        </div>

        <div class="well">
            <fieldset id="userrating_criteria">
                <legend>IMDb Rating</legend> 
                <input type="text" id="ratingRange" value="" name="ratingRange" />
            </fieldset>
        </div>

        <div class="well">
           <fieldset id="rating_criteria" class="dropdown">
             <legend class="control-label">Age Rating</legend>
             <input type="text" placeholder="Choose following... &nbsp;&#9662;" id="ratedText">       
             <div id="MPAA" class="dropdown-content">
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".G" onchange="getRate(this.id)" id="G">
                       <span>G</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".NC-17" onchange="getRate(this.id)" id="NC-17">
                       <span>NC-17</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".PG" onchange="getRate(this.id)" id="PG">
                       <span>PG</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".PG-13" onchange="getRate(this.id)" id="PG-13">
                       <span>PG-13</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".R" onchange="getRate(this.id)" id="R">
                       <span>R</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" onchange="getRate(this.id)" id="Unrated">
                       <span>Unrated</span>
                    </label>
                </div>
             </div>
            
           </fieldset>
        </div>
        
       <div class="well">
           <fieldset id="language_criteria" class="dropdown"s>
             <legend class="control-label">Language</legend>
             <input type="text" placeholder="Choose following... &nbsp;&#9662;" id="languageText">       
             <div id="language" class="dropdown-content">
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Chinese" onchange="getLanguage(this.id)" id="Chinese">     
                       <span>Chinese</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".English" onchange="getLanguage(this.id)" id="English">
                       <span>English</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".French" onchange="getLanguage(this.id)" id="French">
                       <span>French</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".German" onchange="getLanguage(this.id)" id="German">
                       <span>German</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Greek" onchange="getLanguage(this.id)" id="Greek">
                       <span>Greek</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Italian" onchange="getLanguage(this.id)" id="Italian">
                       <span>Italian</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Janpanese" onchange="getLanguage(this.id)" id="Janpanese">
                       <span>Janpanese</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Korean" onchange="getLanguage(this.id)" id="Korean">
                       <span>Korean</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Russian" onchange="getLanguage(this.id)" id="Russian">
                       <span>Russian</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Spanish" onchange="getLanguage(this.id)" id="Spanish">
                       <span>Spanish</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" data-toggle=".Swedish" onchange="getLanguage(this.id)" id="Swedish">
                       <span>Swedish</span>
                    </label>
                </div>
                <div class="checkbox">
                    <label>
                       <input type="checkbox" onchange="getLanguage(this.id)" id="Other">
                       <span>Other languages</span>
                    </label>
                </div>
             </div>
            
           </fieldset>
        </div>
     </nav>

      <div class="col-md-9">
        
      
      <div class="row">
        <div class="col-sm-6">
          <!-- <h4>Most Popular Movies</h4> -->
        </div>
        <div class="col-sm-6">
          <div class="showNum" align="right">Showing 30 Titles</div>
        </div>
      </div>
      <hr>

      <div id="moviesContainer">


      </div>

    </div>

   

     <div id="footer">
      <div class="container">
        <hr>
        <p class="text-muted credit" id="footText">© 2017 Jemma Yang | Find Your Movie</p>
      </div>
    </div>


  </body>
  <script type="text/javascript">
  	$.get("/data", function(data) {
    console.log(data);
    for (var i=0;i<data.length;i++){
        var moviesContainer = document.getElementById("moviesContainer");
        var pageLink = document.createElement('div');
        var view = document.createElement('a');
        var viewText = document.createTextNode('VIEW');
        var layout = document.createElement('div');
        var grid = document.createElement('div');
        var poster = document.createElement('img');
        var textContent = document.createElement('div');
        var name = document.createElement('h4');
        var nameNode = document.createTextNode(data[i].title);
        var year = document.createElement('span');
        var yearNode = document.createTextNode(' (' + data[i].year + ')');
        var imdbRating = document.createElement('div');
        var imdbIcon = document.createElement('img');
        var imdbNode = document.createTextNode(data[i].rating);
        var rottenIcon = document.createElement('img');
        var rottenNode = document.createTextNode(data[i].ratings[1].Value);

        var genres = data[i].genres;
        genres = genres.replace(/\,/g,"");
        var rated = data[i].rated;
        var language = data[i].languages;
        language = language.replace(/\,/g,"");
        var ratingNum = data[i].rating;
        ratingNum = parseInt(ratingNum); 
        ratingNum = Math.floor(ratingNum);

        poster.setAttribute('src', data[i].poster);
        poster.setAttribute('class','poster');
        view.setAttribute('href', 'lalaLand.html');
        grid.setAttribute('class', "moviesGrid");
        layout.setAttribute('class', "col-sm-4 mix " + genres + " " +rated + " " + language + " " + data[i].year + " " + ratingNum );
        year.setAttribute('class','year');
        imdbIcon.setAttribute('src', 'public/images/star.png');
        imdbIcon.setAttribute('class','star');
        imdbRating.setAttribute('class','ratings');
        rottenIcon.setAttribute('src', 'public/images/rotten.png');
        rottenIcon.setAttribute('class','rotten');
        textContent.setAttribute('class','textContent');
        view.setAttribute('class','viewText');
        pageLink.setAttribute('class','overlay');


        name.appendChild(nameNode);
        year.appendChild(yearNode);
        imdbRating.appendChild(imdbIcon);
        imdbRating.appendChild(imdbNode);
        imdbRating.appendChild(rottenIcon);
        imdbRating.appendChild(rottenNode);
        name.appendChild(year);
        view.appendChild(viewText);
        grid.appendChild(poster);
        pageLink.appendChild(view);
        grid.appendChild(textContent);
        textContent.appendChild(name);
        textContent.appendChild(imdbRating);
        grid.appendChild(pageLink);
        layout.appendChild(grid);
        moviesContainer.appendChild(layout);
        
        console.log(layout);
    }

    var mixer = mixitup('#moviesContainer', {
        
          animation: {
             duration: 200
          },
          controls: {
             toggleLogic: 'and'
           }
      });
});

var genreArray =[];
var ratedArray =[];
var languageArray =[];


function run(value){
  var e = document.getElementById("genreText");
 
  if (document.getElementById(value).checked==true){

    genreArray.push(" " + value);
    // e.value += value + ", ";
  }

  else if (document.getElementById(value).checked==false){
    var index = genreArray.indexOf(" " + value);
    
    if (index > -1) {
      genreArray.splice(index, 1);
    }
    // e.value.replace(value,"");
  }
  e.value = genreArray;
}

function getRate(value){
  var e = document.getElementById("ratedText");
  
  if (document.getElementById(value).checked==true){

    ratedArray.push(" " + value);
    // e.value += value + ", ";
  }

  else if (document.getElementById(value).checked==false){
    var index = ratedArray.indexOf(" " + value);
    
    if (index > -1) {
      ratedArray.splice(index, 1);
    }
 
  }
  e.value = ratedArray;
}

function getLanguage(value){
  var e = document.getElementById("languageText");
  
  if (document.getElementById(value).checked==true){

    languageArray.push(" " + value);
    // e.value += value + ", ";
  }

  else if (document.getElementById(value).checked==false){
    var index = languageArray.indexOf(" " + value);
    
    if (index > -1) {
      languageArray.splice(index, 1);
    }
 
  }
  e.value = languageArray;
}


  $(function () {

        $("#yearRange").ionRangeSlider({
            hide_min_max: true,
            keyboard: true,
            min: 2000,
            max: 2017,
            from: 2000,
            to: 2017,
            type: 'double',
            step: 1,
            onFinish: function (year) {
               // resetDisplay();
               year.to = parseInt(year.to)+1;

               var startRange = range(2000, year.from, 1);
               var endRange = range(year.to, 2018, 1);
               var newRangeArray = startRange.concat(endRange);

               console.log(newRangeArray);

               for (var i=0;i<newRangeArray.length;i++){
                   var gridNode = document.getElementsByClassName(newRangeArray[i]);
 
                   if (gridNode.length != 0){
                       console.log('set');
                       for (e = 0; e < gridNode.length; e++) {
                          gridNode[e].style.display = 'none';
                       }
                   } 

                }
          
            },
        });

    });

  $(function () {
        $("#ratingRange").ionRangeSlider({
            hide_min_max: true,
            keyboard: true,
            min: 1,
            max: 10,
            from: 1,
            to: 10,
            type: 'double',
            step: 1,
         
            onFinish: function (data) {
               // resetDisplay();
               data.to = parseInt(data.to)+1;
               var startRange = range(1, data.from, 1);
               var endRange = range(data.to, 11, 1);
               var newRangeArray = startRange.concat(endRange);
               console.log(newRangeArray);

               for (var i=0;i<newRangeArray.length;i++){
                   var gridNode = document.getElementsByClassName(newRangeArray[i]);
 
                   if (gridNode.length != 0){
                       console.log('set');
                       for (e = 0; e < gridNode.length; e++) {
                          gridNode[e].style.display = 'none';
                       }
                   } 

                }
               
             },
        });

    });

function range(from, to, step){
  var fromNode = parseInt(from); 
  var endNode = parseInt(to); 
  var length = endNode - fromNode;
  var rangeArray = [];

  if  (length <= 0){

    rangeArray = [];
  }

  else{
     // fromNode =  fromNode+1;
     for (var i=0;i<length;i++){
        
        var fromString = fromNode.toString();
        rangeArray.push(fromString);
        fromNode = fromNode + step;
     }

  }

  return rangeArray;

}

 function resetDisplay(){
    var gridNode = document.getElementsByClassName('mix');
    
    for (e = 0; e < gridNode.length; e++) { 
     
        gridNode[e].style.display = 'block';
      
    }
 }

  
  </script>

</html>
